# 🎵 음악 분류 시스템 요구사항 분석서

## 📋 프로젝트 개요
AI를 활용한 음악 장르 및 감정 분류 시스템의 상세 요구사항 분석서입니다.

---

## 📊 요구사항 분석표

| 요구사항 아이디 | 요구사항 명 | 상세 요구사항 내용 | 이슈사항 | 해결방안 (변경내역) |
|----------------|------------|-------------------|----------|-------------------|
| **REQ-001** | 오디오 특성 추출 | librosa 라이브러리를 사용하여 오디오 파일에서 멜 스펙트로그램, MFCC, 템포, 크로마그램, 스펙트럴 대비 등의 특성을 추출하는 기능 | - 대용량 오디오 파일 처리 시 메모리 부족 문제<br>- 다양한 샘플링 레이트 지원 필요 | - 최대 60초로 오디오 길이 제한<br>- 샘플링 레이트를 22050Hz로 통일<br>- 정규화 및 표준화 적용 |
| **REQ-002** | 오디오 전처리 | 노이즈 제거, 무음 구간 제거, 볼륨 정규화를 수행하는 기능 | - 노이즈 제거 알고리즘의 성능 문제<br>- 무음 구간 감지 정확도 | - librosa.effects.preemphasis() 사용<br>- top_db=20으로 무음 구간 감지<br>- librosa.util.normalize()로 볼륨 정규화 |
| **REQ-003** | 오디오 파일 검증 | 파일 존재 여부, 크기 제한(100MB), 지원 형식(.mp3, .wav, .m4a, .flac) 검증 기능 | - 파일 크기 제한이 너무 작을 수 있음<br>- 지원 형식 확장 필요 | - 100MB 제한 유지 (메모리 고려)<br>- .ogg, .aac 형식 추가 지원<br>- 파일 존재 여부 및 빈 파일 검증 강화 |
| **REQ-004** | Wav2Vec2 예측 | Hugging Face 사전 훈련 모델을 사용한 고성능 음악 장르 분류 기능 | - 모델 로딩 시간이 길어 사용자 경험 저하<br>- GPU 메모리 부족 문제<br>- 모델 파일 크기가 큼 (약 1GB) | - 모델을 애플리케이션 시작 시 한 번만 로드<br>- GPU 사용 가능 시 자동으로 GPU로 이동<br>- 모델 파일을 로컬에 저장하여 재다운로드 방지 |
| **REQ-005** | 메모리 최적화 | 대용량 모델의 효율적인 메모리 관리 및 GPU 가속 지원 | - 메모리 누수 가능성<br>- GPU 메모리 정리 부족 | - torch.no_grad() 사용으로 그래디언트 계산 비활성화<br>- torch.cuda.empty_cache()로 GPU 메모리 정리<br>- 가비지 컬렉션 강제 실행 |
| **REQ-006** | URL 분류 | URL에서 음악을 다운로드하고 분류하는 기능 | - 다운로드 실패 시 처리<br>- 임시 파일 정리 누락<br>- 네트워크 타임아웃 | - try-finally 블록으로 임시 파일 정리 보장<br>- 300초 타임아웃 설정<br>- 다운로드 실패 시 적절한 에러 메시지 제공 |
| **REQ-007** | 배치 분류 | 여러 URL을 일괄 처리하는 기능 | - 메모리 사용량 급증<br>- 일부 URL 실패 시 전체 중단 | - 각 URL을 개별적으로 처리<br>- 메모리 사용량 모니터링 및 정리<br>- 실패한 URL은 건너뛰고 계속 처리 |
| **REQ-008** | 더미 분류 | 모델이 없을 때 URL 기반 간단한 분류 기능 | - URL 기반 분류의 정확도 낮음<br>- 키워드 매칭의 한계 | - URL에서 키워드 추출하여 장르 추측<br>- 랜덤 선택으로 폴백<br>- 낮은 신뢰도 명시 |
| **REQ-009** | 규칙 기반 분류 | 템포를 기반으로 장르와 감정을 분류하는 기능 | - 템포만으로는 정확한 분류 어려움<br>- 장르별 템포 범위가 겹침 | - 템포 범위를 세분화하여 정확도 향상<br>- 신뢰도 점수 제공<br>- 오류 발생 시 기본값 반환 |
| **REQ-010** | 수동 분류 | 사용자가 직접 장르와 감정을 입력할 수 있는 기능 | - 웹 인터페이스에서 구현 필요<br>- 입력 검증 필요 | - 웹 폼으로 장르/감정 선택<br>- 유효한 값만 입력 가능하도록 제한<br>- 결과 저장 및 표시 |
| **REQ-011** | 하이브리드 분류 | 딥러닝, 규칙 기반, 가사 분석을 결합한 통합 분류 기능 | - 가사 분석 모델 미구현<br>- 각 방법의 가중치 설정 필요 | - 현재는 CNN과 규칙 기반만 결합<br>- 투표 방식으로 최종 결과 결정<br>- 향후 가사 분석 모델 추가 예정 |
| **REQ-012** | 전통적 ML 모델 | SVM, 로지스틱 회귀 등 scikit-learn 기반 모델 | - Wav2Vec2 대비 성능 낮음<br>- 특성 추출 복잡성 | - 현재 미구현 상태<br>- 향후 확장 시 구현 예정<br>- Wav2Vec2가 더 우수한 성능 |
| **REQ-013** | CNN 모델 | TensorFlow/Keras 기반 CNN 모델 | - Wav2Vec2 대비 성능 낮음<br>- 모델 훈련 데이터 필요 | - 현재 미구현 상태<br>- 향후 확장 시 구현 예정<br>- Wav2Vec2가 더 우수한 성능 |
| **REQ-014** | YouTube 다운로드 | yt-dlp를 사용한 YouTube 오디오 다운로드 기능 | - yt-dlp 버전 호환성 문제<br>- FFmpeg 경로 설정 문제<br>- 다운로드 실패 처리 | - yt-dlp 최신 버전 사용<br>- FFmpeg 경로를 절대 경로로 설정<br>- 다운로드 실패 시 재시도 로직 추가 |
| **REQ-015** | 직접 링크 다운로드 | 음악 파일 직접 다운로드 기능 | - 파일 크기 제한 필요<br>- 네트워크 타임아웃 처리<br>- 지원 형식 검증 | - 50MB 크기 제한 설정<br>- 30초 타임아웃 설정<br>- HEAD 요청으로 파일 정보 미리 확인 |
| **REQ-016** | FFmpeg 변환 | 오디오 형식 변환 및 길이 제한 기능 | - FFmpeg 실행 파일 경로 문제<br>- 변환 실패 처리 | - FFmpeg 경로를 프로젝트 내 상대 경로로 설정<br>- 변환 실패 시 원본 파일 사용<br>- 오류 로그 출력 |
| **REQ-017** | 배치 다운로드 | 여러 URL을 동시에 다운로드하는 기능 | - 동시 다운로드로 인한 메모리 부족<br>- 일부 다운로드 실패 시 처리 | - 순차적으로 다운로드하여 메모리 절약<br>- 실패한 URL은 건너뛰고 계속 처리<br>- 결과에 성공/실패 상태 포함 |
| **REQ-018** | 링크 미리보기 | YouTube 정보를 미리 확인하는 기능 | - yt-dlp 실행 시간이 길어 사용자 경험 저하<br>- 정보 가져오기 실패 처리 | - 비동기 처리로 사용자 경험 개선<br>- 실패 시 기본 정보 표시<br>- 설명 길이 제한으로 성능 향상 |
| **REQ-019** | URL 검증 | 지원 플랫폼(YouTube, Spotify, 직접 링크) 확인 기능 | - Spotify 링크는 현재 미지원<br>- URL 형식 검증의 정확도 | - 정규식을 사용한 정확한 URL 검증<br>- Spotify는 검증만 하고 다운로드는 미지원<br>- 지원하지 않는 플랫폼에 대한 명확한 메시지 |
| **REQ-020** | 데이터셋 검증 | 장르별 샘플 수, 오디오 품질, 클래스 밸런스 검증 | - 대용량 데이터셋 검증 시 시간 소요<br>- 오디오 품질 검증의 주관성 | - 첫 5초만 검사하여 성능 향상<br>- 최소 샘플 수를 50개로 설정<br>- 경고와 오류를 구분하여 표시 |
| **REQ-021** | 업로드 폴더 관리 | 오래된 파일 정리 및 폴더 크기 모니터링 | - 파일 삭제 시 권한 문제<br>- 폴더 크기 계산 성능 | - 24시간 이상 된 파일만 삭제<br>- os.walk()를 사용한 효율적인 크기 계산<br>- 삭제 실패 시 로그 출력 |
| **REQ-022** | 메모리 모니터링 | CPU/GPU 메모리 사용량 추적 기능 | - 모니터링 오버헤드<br>- GPU 메모리 정보 가져오기 실패 | - psutil을 사용한 효율적인 모니터링<br>- GPU 정보 가져오기 실패 시 무시<br>- MB 단위로 표시하여 가독성 향상 |
| **REQ-023** | 메모리 최적화 | 가비지 컬렉션 및 GPU 캐시 정리 기능 | - 강제 가비지 컬렉션의 성능 영향<br>- GPU 메모리 정리 실패 | - 적절한 시점에만 가비지 컬렉션 실행<br>- GPU 정리 실패 시 무시<br>- 정리 후 메모리 사용량 확인 |
| **REQ-024** | 캐시 시스템 | 특성 추출 결과 캐싱으로 성능 향상 | - 캐시 크기 제한 필요<br>- 캐시 무효화 전략 | - 메모리 기반 임시 캐시 사용<br>- 파일 해시를 키로 사용<br>- 메모리 부족 시 자동 정리 |
| **REQ-025** | 오디오 처리 | 파일 형식 검증 및 전처리 기능 | - 다양한 오디오 형식 지원 필요<br>- 처리 실패 시 복구 | - 지원 형식 확장 (.ogg, .aac 추가)<br>- 처리 실패 시 기본값 반환<br>- 상세한 오류 메시지 제공 |
| **REQ-026** | 시스템 모니터링 | 실시간 성능 모니터링 기능 | - 모니터링 데이터 저장 필요<br>- 성능 임계값 설정 | - 메모리 사용량 임계값 설정 (2GB, 4GB)<br>- 경고 메시지 출력<br>- 모니터링 데이터를 로그로 저장 |
| **REQ-027** | 데이터 전처리 | 음악 데이터 정규화 및 특성 추출 | - 대용량 데이터 처리 시 메모리 부족<br>- 정규화 방법의 일관성 | - 배치 처리로 메모리 절약<br>- Z-score 정규화 사용<br>- 처리 결과 캐싱 |
| **REQ-028** | 보고서 생성 | JSON 형태 결과 저장 및 통계 분석 | - 대용량 결과 처리 시 성능 문제<br>- 통계 계산의 정확성 | - 스트리밍 방식으로 JSON 저장<br>- 통계 계산을 별도 함수로 분리<br>- 결과 검증 로직 추가 |
| **REQ-029** | Flask 웹 애플리케이션 | RESTful API를 제공하는 웹 서버 | - 동시 사용자 처리 능력 제한<br>- 보안 취약점 | - 단일 사용자용으로 설계<br>- 입력 검증 및 SQL 인젝션 방지<br>- CORS 설정 추가 |
| **REQ-030** | 파일 업로드 | 음악 파일 업로드 및 처리 기능 | - 파일 크기 제한 필요<br>- 업로드 진행률 표시 | - 100MB 파일 크기 제한<br>- JavaScript로 진행률 표시<br>- 업로드 실패 시 에러 메시지 |
| **REQ-031** | URL 분류 인터페이스 | URL 입력 및 분류 기능 | - URL 형식 검증 필요<br>- 분류 진행률 표시 | - 클라이언트 사이드 URL 검증<br>- Server-Sent Events로 진행률 표시<br>- 결과 페이지로 리다이렉트 |
| **REQ-032** | 일괄 분류 인터페이스 | 여러 URL 동시 처리 기능 | - URL 개수 제한 필요<br>- 처리 시간이 길어 사용자 경험 저하 | - 최대 10개 URL로 제한<br>- 백그라운드 처리로 사용자 경험 개선<br>- 진행률 페이지로 리다이렉트 |
| **REQ-033** | 실시간 진행률 | Server-Sent Events 기반 진행률 표시 | - 연결 끊김 처리<br>- 브라우저 호환성 | - 자동 재연결 로직 추가<br>- 폴백으로 폴링 방식 제공<br>- 연결 상태 표시 |
| **REQ-034** | API 엔드포인트 | 모델 상태, URL 검증, 링크 미리보기 API | - API 응답 형식 일관성<br>- 에러 처리 표준화 | - JSON 응답 형식 통일<br>- HTTP 상태 코드 적절히 사용<br>- 에러 메시지 표준화 |
| **REQ-035** | HTML 템플릿 | 반응형 웹 디자인 인터페이스 | - 다양한 브라우저 호환성<br>- 모바일 최적화 | - CSS Grid와 Flexbox 사용<br>- 미디어 쿼리로 반응형 구현<br>- 크로스 브라우저 테스트 |
| **REQ-036** | 다크/화이트 모드 | 사용자 선호에 맞는 테마 제공 | - 테마 상태 저장 필요<br>- 일관된 색상 체계 | - localStorage로 테마 상태 저장<br>- CSS 변수 사용으로 일관성 유지<br>- 토글 버튼으로 쉽게 전환 |
| **REQ-037** | 모바일 최적화 | 다양한 화면 크기에 최적화된 디자인 | - 터치 인터페이스 최적화<br>- 작은 화면에서의 가독성 | - 터치 친화적 버튼 크기<br>- 폰트 크기 조정<br>- 스크롤 최적화 |
| **REQ-038** | 중앙 정렬 레이아웃 | 사용자 경험을 향상시키는 레이아웃 | - 다양한 화면 크기에서의 중앙 정렬<br>- 콘텐츠 길이에 따른 레이아웃 | - CSS Flexbox로 완벽한 중앙 정렬<br>- min-height: 100vh 사용<br>- 세로 중앙 정렬 구현 |
| **REQ-039** | CSS 스타일링 | 모던하고 깔끔한 UI 디자인 | - 일관된 디자인 시스템<br>- 접근성 고려 | - CSS 변수로 색상 체계 통일<br>- ARIA 라벨 추가<br>- 키보드 네비게이션 지원 |
| **REQ-040** | JavaScript 기능 | 파일 업로드 진행률, URL 검증 등 동적 기능 | - 브라우저 호환성<br>- 에러 처리 | - ES6+ 문법 사용<br>- try-catch로 에러 처리<br>- 폴백 기능 제공 |
| **REQ-041** | 링크 미리보기 | URL 정보 미리보기 기능 | - 미리보기 로딩 시간<br>- 정보 표시 공간 | - 비동기 로딩으로 사용자 경험 개선<br>- 모달 형태로 정보 표시<br>- 로딩 스피너 표시 |
| **REQ-042** | 모델 상태 표시 | AI 모델 로드 상태 확인 기능 | - 모델 로딩 상태 실시간 업데이트<br>- 상태 정보의 정확성 | - AJAX로 주기적 상태 확인<br>- 모델 정보 캐싱<br>- 상태 변경 시 자동 업데이트 |
| **REQ-043** | 업로드 폴더 관리 | 웹에서 업로드 폴더 관리 기능 | - 폴더 크기 표시<br>- 파일 목록 표시 | - AJAX로 폴더 정보 조회<br>- 파일 크기를 사람이 읽기 쉬운 형태로 변환<br>- 파일 목록을 테이블로 표시 |
| **REQ-044** | 진행률 페이지 | 실시간 진행률 표시 전용 페이지 | - 페이지 새로고침 시 진행률 유지<br>- 완료 후 결과 표시 | - Server-Sent Events로 실시간 업데이트<br>- 완료 시 결과 페이지로 리다이렉트<br>- 오류 발생 시 에러 메시지 표시 |
| **REQ-045** | 패키지 설치 스크립트 | 필요한 Python 패키지 자동 설치 | - 패키지 버전 호환성 문제<br>- 설치 실패 처리 | - requirements.txt의 정확한 버전 사용<br>- 설치 실패 시 상세한 오류 메시지<br>- 의존성 순서 고려 |
| **REQ-046** | 최적화 설정 스크립트 | 시스템 최적화 설정 자동 구성 | - 시스템별 최적화 설정 차이<br>- 설정 적용 실패 | - OS별 최적화 설정 제공<br>- 설정 적용 전 백업<br>- 적용 결과 검증 |
| **REQ-047** | 통합 테스트 | 전체 시스템 통합 테스트 | - 테스트 데이터 준비<br>- 테스트 환경 구성 | - 모의 데이터 생성<br>- 테스트 환경 분리<br>- 자동화된 테스트 실행 |
| **REQ-048** | 메인 실행 파일 | 전체 시스템 실행 관리 | - 모듈 import 오류<br>- 실행 환경 설정 | - 상대 경로 import 사용<br>- 실행 환경 검증<br>- 오류 발생 시 상세한 메시지 |
| **REQ-049** | 의존성 관리 | Python 패키지 및 버전 관리 | - 패키지 버전 충돌<br>- 플랫폼별 의존성 | - 정확한 버전 명시<br>- 플랫폼별 requirements.txt<br>- 가상환경 사용 권장 |
| **REQ-050** | 프로젝트 문서화 | 사용법, 설치 방법, 기능 설명 문서 | - 문서 업데이트 지연<br>- 사용자 이해도 | - 코드 변경 시 문서 동시 업데이트<br>- 예시와 스크린샷 포함<br>- 사용자 피드백 반영 |

---

## 📊 요구사항 분석 요약

### 🎯 **반영 요구사항 (46개)**
- **핵심 기능**: 오디오 처리, AI 분류, 웹 인터페이스
- **주요 이슈**: 메모리 최적화, 성능 향상, 사용자 경험
- **해결방안**: 캐싱, 비동기 처리, 에러 처리 강화

### 🚫 **미반영 요구사항 (4개)**
- **전통적 ML 모델**: Wav2Vec2가 더 우수한 성능
- **CNN 모델**: Wav2Vec2가 더 우수한 성능
- **향후 확장 예정**: 필요 시 추가 구현

### 🔧 **주요 해결방안**
1. **메모리 최적화**: GPU 메모리 정리, 가비지 컬렉션
2. **성능 향상**: 캐싱 시스템, 비동기 처리
3. **사용자 경험**: 실시간 진행률, 에러 처리
4. **안정성**: 입력 검증, 예외 처리

---

## 📝 작성 정보

- **작성일**: 2025년 1월 19일
- **작성자**: AI Assistant
- **프로젝트**: 음악 분류 시스템
- **버전**: 1.0

---

## 📋 결론

이 요구사항 분석서는 음악 분류 시스템의 모든 기능에 대한 상세한 분석을 제공합니다. 각 요구사항의 이슈사항과 해결방안을 명확히 제시하여 개발 과정에서 참고할 수 있도록 구성했습니다.

- **총 요구사항**: 50개
- **반영 요구사항**: 46개 (92%)
- **미반영 요구사항**: 4개 (8%)
- **주요 해결방안**: 메모리 최적화, 성능 향상, 사용자 경험 개선
