# 🎵 음악 분류 시스템 요구사항 정의서

## 📋 프로젝트 개요
AI를 활용한 음악 장르 및 감정 분류 시스템으로, Wav2Vec2 모델을 기반으로 한 고성능 음악 분류와 웹 인터페이스를 제공합니다.

---

## 📊 요구사항 정의표

| 구분 대분류 | 구분 소분류 | 내용 | 출처 | 반영여부 | 적용방안 |
|------------|------------|------|------|----------|----------|
| **주요기능 (백엔드)** | 오디오 특성 추출 | librosa 라이브러리를 사용하여 오디오 파일에서 멜 스펙트로그램, MFCC, 템포, 크로마그램, 스펙트럴 대비 등의 특성을 추출하는 기능 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 오디오 전처리 | 노이즈 제거, 무음 구간 제거, 볼륨 정규화를 수행하는 기능 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 오디오 파일 검증 | 파일 존재 여부, 크기 제한(100MB), 지원 형식(.mp3, .wav, .m4a, .flac) 검증 기능 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | Wav2Vec2 예측 | Hugging Face 사전 훈련 모델을 사용한 고성능 음악 장르 분류 기능 | 직접 작성 (Hugging Face transformers 라이브러리 활용) | 반영한다 | 소스코드를 그대로 적용 |
| | 메모리 최적화 | 대용량 모델의 효율적인 메모리 관리 및 GPU 가속 지원 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | URL 분류 | URL에서 음악을 다운로드하고 분류하는 기능 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 배치 분류 | 여러 URL을 일괄 처리하는 기능 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 더미 분류 | 모델이 없을 때 URL 기반 간단한 분류 기능 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 규칙 기반 분류 | 템포를 기반으로 장르와 감정을 분류하는 기능 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 수동 분류 | 사용자가 직접 장르와 감정을 입력할 수 있는 기능 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 하이브리드 분류 | 딥러닝, 규칙 기반, 가사 분석을 결합한 통합 분류 기능 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 전통적 ML 모델 | SVM, 로지스틱 회귀 등 scikit-learn 기반 모델 | 직접 작성 | 반영하지 않는다 | 향후 확장 시 구현 예정 |
| | CNN 모델 | TensorFlow/Keras 기반 CNN 모델 | 직접 작성 | 반영하지 않는다 | 향후 확장 시 구현 예정 |
| | YouTube 다운로드 | yt-dlp를 사용한 YouTube 오디오 다운로드 기능 | 직접 작성 (yt-dlp 라이브러리 활용) | 반영한다 | 소스코드를 그대로 적용 |
| | 직접 링크 다운로드 | 음악 파일 직접 다운로드 기능 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | FFmpeg 변환 | 오디오 형식 변환 및 길이 제한 기능 | 직접 작성 (FFmpeg 라이브러리 활용) | 반영한다 | 소스코드를 그대로 적용 |
| | 배치 다운로드 | 여러 URL을 동시에 다운로드하는 기능 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 링크 미리보기 | YouTube 정보를 미리 확인하는 기능 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | URL 검증 | 지원 플랫폼(YouTube, Spotify, 직접 링크) 확인 기능 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 데이터셋 검증 | 장르별 샘플 수, 오디오 품질, 클래스 밸런스 검증 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 업로드 폴더 관리 | 오래된 파일 정리 및 폴더 크기 모니터링 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 메모리 모니터링 | CPU/GPU 메모리 사용량 추적 기능 | 직접 작성 (psutil, torch 라이브러리 활용) | 반영한다 | 소스코드를 그대로 적용 |
| | 메모리 최적화 | 가비지 컬렉션 및 GPU 캐시 정리 기능 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 캐시 시스템 | 특성 추출 결과 캐싱으로 성능 향상 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 오디오 처리 | 파일 형식 검증 및 전처리 기능 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 시스템 모니터링 | 실시간 성능 모니터링 기능 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 데이터 전처리 | 음악 데이터 정규화 및 특성 추출 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 보고서 생성 | JSON 형태 결과 저장 및 통계 분석 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| **디자인 부분 (프론트엔드)** | Flask 웹 애플리케이션 | RESTful API를 제공하는 웹 서버 | 직접 작성 (Flask 라이브러리 활용) | 반영한다 | 소스코드를 그대로 적용 |
| | 파일 업로드 | 음악 파일 업로드 및 처리 기능 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | URL 분류 인터페이스 | URL 입력 및 분류 기능 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 일괄 분류 인터페이스 | 여러 URL 동시 처리 기능 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 실시간 진행률 | Server-Sent Events 기반 진행률 표시 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | API 엔드포인트 | 모델 상태, URL 검증, 링크 미리보기 API | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | HTML 템플릿 | 반응형 웹 디자인 인터페이스 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 다크/화이트 모드 | 사용자 선호에 맞는 테마 제공 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 모바일 최적화 | 다양한 화면 크기에 최적화된 디자인 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 중앙 정렬 레이아웃 | 사용자 경험을 향상시키는 레이아웃 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | CSS 스타일링 | 모던하고 깔끔한 UI 디자인 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | JavaScript 기능 | 파일 업로드 진행률, URL 검증 등 동적 기능 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 링크 미리보기 | URL 정보 미리보기 기능 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 모델 상태 표시 | AI 모델 로드 상태 확인 기능 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 업로드 폴더 관리 | 웹에서 업로드 폴더 관리 기능 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 진행률 페이지 | 실시간 진행률 표시 전용 페이지 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| **추가기능** | 패키지 설치 스크립트 | 필요한 Python 패키지 자동 설치 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 최적화 설정 스크립트 | 시스템 최적화 설정 자동 구성 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 통합 테스트 | 전체 시스템 통합 테스트 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 메인 실행 파일 | 전체 시스템 실행 관리 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 의존성 관리 | Python 패키지 및 버전 관리 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 프로젝트 문서화 | 사용법, 설치 방법, 기능 설명 문서 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | 개발 진행 추적 | TODO 리스트 및 개발 계획 관리 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |
| | Git 버전 관리 | .gitignore 및 버전 관리 설정 | 직접 작성 | 반영한다 | 소스코드를 그대로 적용 |

---

## 🎯 지원하는 분류 방법

1. **Wav2Vec2 (AI)**: Hugging Face 사전 훈련 모델 - 가장 정확한 분류
2. **규칙 기반**: 템포 기반 간단한 분류 (빠른 처리)
3. **수동 분류**: 사용자가 직접 장르/감정 입력
4. **전통적 ML**: SVM, 로지스틱 회귀 등 scikit-learn 모델
5. **하이브리드**: 여러 방법을 결합한 통합 분류

## 🎼 지원하는 장르 (Wav2Vec2 모델 기준)

- **블루스** (blues)
- **클래식** (classical) 
- **컨트리** (country)
- **디스코** (disco)
- **힙합** (hiphop)
- **재즈** (jazz)
- **메탈** (metal)
- **팝** (pop)
- **레게** (reggae)
- **록** (rock)

## 😊 지원하는 감정 (규칙 기반)

- **행복한**: 빠른 템포 (120+ BPM)
- **슬픈**: 느린 템포 (80-100 BPM)
- **평화로운**: 매우 느린 템포 (80- BPM)
- **열정적인**: 매우 빠른 템포 (140+ BPM)

## 🔗 URL 지원

- **YouTube**: youtube.com, youtu.be 링크
- **직접 링크**: MP3, WAV, M4A, FLAC 파일
- **일괄 처리**: 여러 URL 동시 분류
- **링크 미리보기**: URL 정보 미리보기 기능

## 📈 성능 모니터링

- **실시간 메모리 추적**: CPU/GPU 메모리 사용량 모니터링
- **진행률 표시**: Server-Sent Events 기반 실시간 진행률
- **캐시 시스템**: 동일 파일 재분석 시 성능 향상
- **메모리 최적화**: 대용량 모델 효율적 관리
- **결과 저장**: JSON 형태로 분류 결과 저장

## 🌐 API 엔드포인트

### 웹 인터페이스
- `GET /`: 메인 페이지
- `POST /classify`: 파일 업로드 분류
- `POST /classify_url`: URL 분류
- `POST /batch_classify`: 일괄 URL 분류

### RESTful API
- `GET /api/model_status`: 모델 상태 조회
- `POST /api/validate_url`: URL 검증
- `POST /api/link_preview`: 링크 미리보기
- `GET /api/progress/<task_id>`: 분류 진행률 조회
- `GET /api/progress_stream/<task_id>`: 실시간 진행률 스트리밍
- `POST /clear_uploads`: 업로드 폴더 정리
- `GET /get_uploads_info`: 업로드 폴더 정보

---

## 📝 작성 정보

- **작성일**: 2025년 1월 19일
- **작성자**: AI Assistant
- **프로젝트**: 음악 분류 시스템
- **버전**: 1.0

---

## 📋 요약

이 요구사항 정의서는 음악 분류 시스템의 모든 기능을 체계적으로 정리한 문서입니다. 

- **총 기능 수**: 50개
- **반영 기능**: 46개 (92%)
- **미반영 기능**: 4개 (8%) - 향후 확장 예정
- **주요 기술**: Wav2Vec2, Flask, librosa, yt-dlp, FFmpeg

모든 기능이 명확하게 분류되어 있어 개발 계획 수립이나 기능 확장 시 참고하기 좋습니다.